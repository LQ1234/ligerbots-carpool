!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t){function a(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,a){return t&&i(e.prototype,t),a&&i(e,a),e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m(e);if(t){var r=m(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return d(this,a)}}function d(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function v(e){return e.ok?e.text():Promise.reject("Could not contact server")}function f(e){return N(O(e))}function R(e,t){var a={};for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])&&(a[n]=e[n]);return a}var E=function(e){c(a,React.Component);var t=u(a);function a(e){var n;return s(this,a),g(h(n=t.call(this,e)),"newEventPressed",(function(){n.props.showPopup({view:j,newMode:!0})})),n}return p(a,[{key:"render",value:function(){var e=this;return React.createElement(React.Fragment,null,React.createElement("div",{className:"title"},"Events"),React.createElement("div",{id:"events"},Object.values(this.props.events).map((function(t){return React.createElement(w,o({popupMessageFunctions:e.props.popupMessageFunctions,showPopup:e.props.showPopup,changeView:e.props.changeView},t,{key:t.id}))}))),React.createElement("br",null),React.createElement("button",{type:"button",name:"button",onClick:this.newEventPressed},"New Event"),React.createElement("br",null))}}]),a}(),w=function(e){c(a,React.Component);var t=u(a);function a(e){var n;return s(this,a),g(h(n=t.call(this,e)),"editClicked",(function(){n.props.showPopup({view:j,newMode:!1,id:n.props.id})})),g(h(n),"addClicked",(function(e){n.props.changeView("add-form",n.props.id,D(e))})),g(h(n),"driverViewClicked",(function(e){n.props.changeView("driver-view",n.props.id,D(e))})),g(h(n),"participantViewClicked",(function(e){n.props.changeView("participant-view",n.props.id,D(e))})),n}return p(a,[{key:"render",value:function(){var e=moment(this.props.date);return React.createElement("div",null,React.createElement("div",{className:"title"},this.props.title,React.createElement("span",{className:"date"},e.calendar({sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"}))),React.createElement("div",{className:"dbbox"},React.createElement("div",{className:"description"},React.createElement("div",{className:"note"},this.props.note),React.createElement("div",{className:"statistics"},React.createElement("strong",null,this.props.stats.amountCarpools)," carpools have the capacity of ",React.createElement("strong",null,this.props.stats.totalCapacity)," people.",React.createElement("br",null),React.createElement("strong",null,this.props.stats.takenDeparting)," seats taken in departing trip, ",React.createElement("strong",null,this.props.stats.takenReturning)," seats taken in returning trip.",React.createElement("br",null),React.createElement("strong",null,this.props.stats.departingWaitlist)," people are on the departing waitlist and ",React.createElement("strong",null,this.props.stats.returningWaitlist)," people are on the returning waitlist.",React.createElement("br",null),React.createElement("br",null),"Default departing time: ",React.createElement("strong",null,this.props.defaultDepartingTime),"  Default returning time: ",React.createElement("strong",null,this.props.defaultReturningTime),React.createElement("br",null))),React.createElement("div",{className:"buttons"},React.createElement("button",{type:"button",name:"button",onClick:this.addClicked},"Add Participant/Carpool"),React.createElement("br",null),React.createElement("button",{type:"button",name:"button",onClick:this.driverViewClicked},"Driver View"),React.createElement("br",null),React.createElement("button",{type:"button",name:"button",onClick:this.participantViewClicked},"Participant View"),React.createElement("br",null),React.createElement("button",{type:"button",name:"button",onClick:this.editClicked},"Edit"),React.createElement("br",null))))}}]),a}(),C=function(e){c(a,React.Component);var t=u(a);function a(e){var r;return s(this,a),g(h(r=t.call(this,e)),"handlePersonalInformationChange",(function(e){var t=e.target;r.setState({personalInformation:n(n({},r.state.personalInformation),{},g({},t.name,t.value))})})),g(h(r),"handleNewCarpoolChange",(function(e){var t=e.target;if("seats"==t.name){var a=parseInt(t.value);if(""==t.value&&(a=0),isNaN(a))return;return a<1&&(a=1),a>200&&(a=200),void r.setState({newCarpool:n(n({},r.state.newCarpool),{},{seats:a})})}r.setState({newCarpool:n(n({},r.state.newCarpool),{},g({},t.name,t.value))})})),g(h(r),"handleSelectedCarpoolsChange",(function(e,t){r.setState((function(a){return n(n({},a),{},{selectedCarpools:n(n({},a.selectedCarpools),{},g({},e?"departing":"returning",t))})})),console.log("updatedCarpoolSelection.type",t.type),2==t.type&&""==r.state.newCarpool.name&&(r.state.newCarpool.name=r.state.personalInformation.name+"'s Carpool")})),g(h(r),"addButtonClicked",(function(e){var t=O(n({eventId:r.props.eventId,personalInformation:r.state.personalInformation,carpool:r.state.selectedCarpools},r.state.newCarpool));console.log("req",t),fetch("api/add-carpool-or-participant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.props.goToEvents()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage)})),g(h(r),"eventPressed",(function(){r.props.showPopup({view:j,newMode:!1,id:r.props.eventId})})),r.state={selectedCarpools:{departing:{type:0,carpoolId:0},returning:{type:0,carpoolId:0}},personalInformation:{name:"",email:"",number:"",note:""},newCarpool:{name:"",origin:"",departingTime:"",returningTime:"",seats:4,note:""}},r}return p(a,[{key:"render",value:function(){var e=2==this.state.selectedCarpools.departing.type||2==this.state.selectedCarpools.returning.type;return React.createElement(React.Fragment,null,React.createElement("div",{className:"subtitle"},React.createElement("button",{className:"backbutton",onClick:this.props.goToEvents},"←")," Add Participant/Carpool to ",React.createElement("span",{className:"imbeddedEvent",onClick:this.eventPressed},this.props.events[this.props.eventId].title)),React.createElement("div",{className:"sectiontitle"},"Information"),React.createElement("div",{className:"section"},React.createElement("div",{className:"infoGrid"},React.createElement("label",null,React.createElement("span",null,"Name: "),React.createElement("input",{name:"name",value:this.state.personalInformation.name,onChange:this.handlePersonalInformationChange})),React.createElement("label",null,React.createElement("span",null,"Email: "),React.createElement("input",{name:"email",value:this.state.personalInformation.email,onChange:this.handlePersonalInformationChange})),React.createElement("label",null,React.createElement("span",null,"Number: "),React.createElement("input",{name:"number",value:this.state.personalInformation.number,onChange:this.handlePersonalInformationChange})),React.createElement("label",null,React.createElement("span",null,"Note: "),React.createElement("br",null),React.createElement("textarea",{name:"note",value:this.state.personalInformation.note,onChange:this.handlePersonalInformationChange})))),React.createElement("div",{className:"sectiontitle"},"Carpool"),React.createElement("div",{className:"section"},"Departing Trip: ",React.createElement(y,{includeNewCarpool:!0,participants:this.props.participants,isDepartingTrip:!0,availableCarpools:this.props.availableCarpools,selectedCarpools:this.state.selectedCarpools,selectedCarpoolsChangeHandler:this.handleSelectedCarpoolsChange}),"  Returning Trip: ",React.createElement(y,{includeNewCarpool:!0,participants:this.props.participants,isDepartingTrip:!1,availableCarpools:this.props.availableCarpools,selectedCarpools:this.state.selectedCarpools,selectedCarpoolsChangeHandler:this.handleSelectedCarpoolsChange})),React.createElement("br",null),React.createElement("div",{className:"sectiontitle"},"New Carpool"),React.createElement("div",{className:"section"},React.createElement("div",{className:"infoGrid"},React.createElement("label",null,React.createElement("span",null,"Name: "),React.createElement("input",{disabled:!e,name:"name",value:this.state.newCarpool.name,onChange:this.handleNewCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Origin: "),React.createElement("input",{disabled:!e,name:"origin",value:this.state.newCarpool.origin,onChange:this.handleNewCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Departing Time: "),React.createElement("input",{disabled:!e,name:"departingTime",value:this.state.newCarpool.departingTime,onChange:this.handleNewCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Return Time: "),React.createElement("input",{disabled:!e,name:"returningTime",value:this.state.newCarpool.returningTime,onChange:this.handleNewCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Seats: "),React.createElement("input",{disabled:!e,type:"number",name:"seats",value:this.state.newCarpool.seats,onChange:this.handleNewCarpoolChange}),"  (Include Driver)"),React.createElement("label",null,React.createElement("span",null,"Note: "),React.createElement("br",null),React.createElement("textarea",{disabled:!e,name:"note",value:this.state.newCarpool.note,onChange:this.handleNewCarpoolChange})))),React.createElement("button",{onClick:this.addButtonClicked},"Add"))}}]),a}(),y=function(e){c(a,React.Component);var t=u(a);function a(e){var n;return s(this,a),g(h(n=t.call(this,e)),"handleClick",(function(e){n.setState({isOpen:!0})})),g(h(n),"handleHide",(function(e){n.setState({isOpen:!1})})),n.state={isOpen:!1},n.selectorDropdown=React.createRef(),n.resizeListener=function(){var e,t,a;null!=n.selectorDropdown.current&&(e=n.selectorDropdown.current,t=e.parentElement.querySelector(".selectorButton").getBoundingClientRect(),a=document.documentElement.clientWidth,t.x+500+20<a?(e.style.width="".concat(500,"px"),e.style.right="auto",e.style.left="auto"):540<a?(e.style.width="".concat(500,"px"),e.style.right="".concat(20,"px"),e.style.left="auto"):(e.style.width="auto",e.style.right="".concat(20,"px"),e.style.left="".concat(20,"px")))},n}return p(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizeListener),this.resizeListener()}},{key:"componentDidUpdate",value:function(){this.resizeListener()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeListener)}},{key:"render",value:function(){var e=this,t=this.props.selectedCarpools[this.props.isDepartingTrip?"departing":"returning"],a="";switch(t.type){case 0:a="Waitlist";break;case 1:a="Parent";break;case 2:a="New Carpool";break;default:var n=Object.values(this.props.availableCarpools).find((function(e){return e.id==t.carpoolId}));a=n?n.name:"<Invalid carpool>"}return React.createElement("div",{className:"carpoolSelector"},React.createElement("button",{className:"selectorButton",onClick:this.handleClick},a),this.state.isOpen?React.createElement(React.Fragment,null,React.createElement("div",{className:"clickDetect",onClick:this.handleHide}),React.createElement("div",{className:"selectorDropdown",ref:this.selectorDropdown},React.createElement("div",{className:"label selectorRow"},React.createElement("div",{className:"carpoolName"},"Name"),React.createElement("div",{className:"carpoolOrigin"},"Origin"),React.createElement("div",{className:"carpoolTime"},"Time")),React.createElement("a",{className:1==t.type?"selectorRow selected":"selectorRow",onClick:function(){e.props.selectedCarpoolsChangeHandler(e.props.isDepartingTrip,{type:1,carpoolId:-1}),e.handleHide()}},React.createElement("div",{className:"carpoolName"},"Parent")),Object.values(this.props.availableCarpools).map((function(a){var n=e.props.isDepartingTrip?a.takenDeparting:a.takenReturning,r=["selectorRow"],o=e.props.participants[a.driverId];if(!o)return React.createElement("div",{className:"selectorRow",key:a.id},"?[err no driver]");var s=(e.props.isDepartingTrip?3==o.carpool.departing.type&&o.carpool.departing.carpoolId==a.id:3==o.carpool.returning.type&&o.carpool.returning.carpoolId==a.id)?a.seats:0,i=n>=s;return a.id==t.carpoolId&&3==t.type&&r.push("selected"),i&&r.push("disabled"),React.createElement("a",{className:r.join(" "),key:a.id,onClick:i?null:function(){e.props.selectedCarpoolsChangeHandler(e.props.isDepartingTrip,{type:3,carpoolId:a.id}),e.handleHide()}},React.createElement("div",{className:"carpoolName"},a.name,React.createElement("span",{className:"carpoolCount"},n,"/",s)),React.createElement("div",{className:"carpoolOrigin"},a.origin),React.createElement("div",{className:"carpoolTime"},e.props.isDepartingTrip?a.departingTime:a.returningTime))})),React.createElement("a",{className:0==t.type?"selectorRow selected":"selectorRow",onClick:function(){e.props.selectedCarpoolsChangeHandler(e.props.isDepartingTrip,{type:0,carpoolId:-1}),e.handleHide()}},React.createElement("div",{className:"carpoolName"},"Waitlist")),this.props.includeNewCarpool?React.createElement("a",{className:2==t.type?"selectorRow selected":"selectorRow",onClick:function(){e.props.selectedCarpoolsChangeHandler(e.props.isDepartingTrip,{type:2,carpoolId:-1}),e.handleHide()}},React.createElement("div",{className:"carpoolName"},"New Carpool")):null)):null)}}]),a}();var b=function(e){c(a,React.Component);var t=u(a);function a(e){var r;return s(this,a),g(h(r=t.call(this,e)),"showDropOutline",(function(){0==r.state.dropOutlineShown&&r.setState({dropOutlineShown:!0})})),g(h(r),"eventPressed",(function(){r.props.showPopup({view:j,newMode:!1,id:r.props.eventId})})),g(h(r),"startDrag",(function(e,t){r.setState({dropTargetsShown:!0,dropTargetDeparting:e,dropTargetParticipantId:t})})),g(h(r),"dragSet",(function(e){r.setState({dropTargetCarpool:e})})),g(h(r),"endDrag",(function(){var e=r.state.dropTargetParticipantId;if(e in r.props.participants&&r.state.dropTargetCarpool){var t=O(n({},r.props.participants[e]));r.state.dropTargetDeparting?(t.carpool_departing_type=parseInt(r.state.dropTargetCarpool.type),t.carpool_departing_carpoolId=parseInt(r.state.dropTargetCarpool.carpoolId)):(t.carpool_returning_type=parseInt(r.state.dropTargetCarpool.type),t.carpool_returning_carpoolId=parseInt(r.state.dropTargetCarpool.carpoolId)),fetch("api/edit-participant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e)})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage)}r.setState({dropTargetsShown:!1,dropTargetDeparting:!1})})),r.state={dropTargetsShown:!1,dropTargetDeparting:!1,dropTargetCarpool:null,dropTargetParticipantId:null},r.dropHandlers={startDrag:r.startDrag,dragSet:r.dragSet,endDrag:r.endDrag},r}return p(a,[{key:"render",value:function(){for(var e=this,t={},a=[],n=[],r={},s=[],i=[],p=0,c=Object.keys(this.props.participants);p<c.length;p++){var l=c[p],u=this.props.participants[l];switch(u.carpool.departing.type){case 0:a.push(l);break;case 1:n.push(l);break;default:var d=u.carpool.departing.carpoolId;d in t||(t[d]=[]),t[d].push(l)}}for(var h=0,m=Object.keys(this.props.participants);h<m.length;h++){var g=m[h],v=this.props.participants[g];switch(v.carpool.returning.type){case 0:s.push(g);break;case 1:i.push(g);break;default:var f=v.carpool.returning.carpoolId;f in r||(r[f]=[]),r[f].push(g)}}var R=0,E={dropTargetsShown:this.state.dropTargetsShown,dropTargetDeparting:this.state.dropTargetDeparting,dropTargetCarpool:this.state.dropTargetCarpool};return React.createElement(React.Fragment,null,React.createElement("div",{className:"subtitle"},React.createElement("button",{className:"backbutton",onClick:this.props.goToEvents},"←")," Driver View for ",React.createElement("span",{className:"imbeddedEvent",onClick:this.eventPressed},this.props.events[this.props.eventId].title)),"Hold & drag to change carpools, click to inspect.",React.createElement("br",null),React.createElement("br",null),React.createElement("div",{className:"driverViewGrid"+(this.props.dropOutlineShown?" dropOutline":"")},React.createElement("div",{className:"tripKey"},"Departing"),React.createElement("div",{className:"tripKey"},"Returning"),Object.keys(this.props.carpools).map((function(a){return React.createElement(P,o({dropHandlers:e.dropHandlers},E,{row:R+=2,showPopup:e.props.showPopup,showDropOutline:e.showDropOutline,key:a,for:{type:3,carpoolId:a},containingDeparting:t[a]||[],containingReturning:r[a]||[],participants:e.props.participants,carpools:e.props.carpools}))})),React.createElement(P,o({dropHandlers:this.dropHandlers},E,{row:R+=2,showPopup:this.props.showPopup,showDropOutline:this.showDropOutline,for:{type:0,carpoolId:-1},containingDeparting:a,containingReturning:s,participants:this.props.participants,carpools:this.props.carpools})),React.createElement(P,o({dropHandlers:this.dropHandlers},E,{row:R+=2,showPopup:this.props.showPopup,showDropOutline:this.showDropOutline,for:{type:1,carpoolId:-1},containingDeparting:n,containingReturning:i,participants:this.props.participants,carpools:this.props.carpools}))))}}]),a}(),P=function(e){c(a,React.Component);var t=u(a);function a(e){var n;return s(this,a),g(h(n=t.call(this,e)),"carpoolPressed",(function(){3==n.props.for.type&&n.props.showPopup({view:M,id:n.props.for.carpoolId})})),n}return p(a,[{key:"render",value:function(){var e,t=this,a=this.props,n="";switch(a.for.type){case 0:e="Waitlist";break;case 1:e="Parent";break;default:var r=a.carpools[a.for.carpoolId],o=this.props.participants[r.driverId];if(!o){n="Driverless";break}3==o.carpool.departing.type&&o.carpool.departing.carpoolId==r.id?n+="".concat(r.takenDeparting,"/").concat(r.seats):n+="No Departing Trip",n+=", ",3==o.carpool.returning.type&&o.carpool.returning.carpoolId==r.id?n+="".concat(r.takenReturning,"/").concat(r.seats):n+="No Returning Trip",e=r.name}var s=3==a.for.type?a.carpools[a.for.carpoolId].driverId:-1;s>=0&&!(s in a.participants)&&(s=-1);var i=this.props.dropTargetCarpool&&this.props.dropTargetCarpool.type==this.props.for.type&&(3!=this.props.for.type||this.props.dropTargetCarpool.carpoolId==this.props.for.carpoolId);return React.createElement(React.Fragment,null,this.props.dropTargetsShown?this.props.dropTargetDeparting?React.createElement("div",{className:"dropTarget"+(i?" hover":""),style:{gridRow:"".concat(this.props.row," / span 2"),gridColumn:1},"data-type":this.props.for.type,"data-carpool-id":this.props.for.carpoolId}):React.createElement("div",{className:"dropTarget"+(i?" hover":""),style:{gridRow:"".concat(this.props.row," / span 2"),gridColumn:2},"data-type":this.props.for.type,"data-carpool-id":this.props.for.carpoolId}):null,React.createElement("div",{style:{gridRow:this.props.row},className:"carpoolHeader"+(3==this.props.for.type?" underlineable":""),onClick:this.carpoolPressed},e,React.createElement("span",{className:"countInfo"},n)),React.createElement("div",{style:{gridRow:this.props.row+1,gridColumn:1},className:"carpoolTripContainer"},s>=0&&3==a.participants[s].carpool.departing.type&&a.participants[s].carpool.departing.carpoolId==a.for.carpoolId?React.createElement(k,{isDepartingTrip:!0,dropHandlers:this.props.dropHandlers,showPopup:this.props.showPopup,showDropOutline:this.props.showDropOutline,key:s,isDriver:!0,participant:a.participants[s]}):null,a.containingDeparting.map((function(e){return s==e?null:React.createElement(k,{isDepartingTrip:!0,dropHandlers:t.props.dropHandlers,showPopup:t.props.showPopup,showDropOutline:t.props.showDropOutline,key:e,isDriver:!1,participant:a.participants[e]})}))),React.createElement("div",{style:{gridRow:this.props.row+1,gridColumn:2},className:"carpoolTripContainer"},s>=0&&3==a.participants[s].carpool.returning.type&&a.participants[s].carpool.returning.carpoolId==a.for.carpoolId?React.createElement(k,{isDepartingTrip:!1,dropHandlers:this.props.dropHandlers,showPopup:this.props.showPopup,showDropOutline:this.props.showDropOutline,key:s,isDriver:!0,participant:a.participants[s]}):null,a.containingReturning.map((function(e){return s==e?null:React.createElement(k,{isDepartingTrip:!1,dropHandlers:t.props.dropHandlers,showPopup:t.props.showPopup,showDropOutline:t.props.showDropOutline,key:e,isDriver:!1,participant:a.participants[e]})}))))}}]),a}(),k=function(e){c(a,React.Component);var t=u(a);function a(e){var n;return s(this,a),g(h(n=t.call(this,e)),"holdTime",300),g(h(n),"mouseDownListener",(function(e){n.removeMouseListeners(),n.startDragPos.x=e.pageX,n.startDragPos.y=e.pageY,n.addMouseListeners()})),g(h(n),"mouseMoveListener",(function(e){n.dropStartHandler(),n.setState({dragpos:{x:e.pageX-n.startDragPos.x,y:e.pageY-n.startDragPos.y}}),n.dropMoveHandler(e.clientX,e.clientY)})),g(h(n),"mouseUpListener",(function(e){0==n.state.dragpos.x&&0==n.state.dragpos.y?n.clickListener():(n.setState({dragpos:{x:0,y:0}}),n.dropEndHandler()),n.removeMouseListeners()})),g(h(n),"touchStartListener",(function(e){e.preventDefault(),n.removeTouchListeners(),n.startDragPos.x=e.touches[0].pageX,n.startDragPos.y=e.touches[0].pageY,n.addTouchListeners(),n.holdStart=performance.now(),n.holdTimeout=setTimeout((function(){n.setState({dragpos:{x:0,y:1e-5}}),n.dropStartHandler()}),n.holdTime)})),g(h(n),"touchMoveListener",(function(e){performance.now()-n.holdStart>n.holdTime?(e.preventDefault(),clearTimeout(n.holdTimeout),n.setState({dragpos:{x:e.touches[0].pageX-n.startDragPos.x,y:e.touches[0].pageY-n.startDragPos.y}}),n.dropMoveHandler(e.touches[0].clientX,e.touches[0].clientY)):(Math.abs(e.touches[0].pageX-n.startDragPos.x>5)||Math.abs(e.touches[0].pageY-n.startDragPos.y)>5)&&(clearTimeout(n.holdTimeout),n.removeTouchListeners(),n.setState({dragpos:{x:0,y:0}}))})),g(h(n),"touchEndListener",(function(e){clearTimeout(n.holdTimeout),performance.now()-n.holdStart<n.holdTime?n.clickListener():n.dropEndHandler(),e.preventDefault(),n.setState({dragpos:{x:0,y:0}}),n.removeTouchListeners()})),g(h(n),"dropStartHandler",(function(){n.props.dropHandlers.startDrag(n.props.isDepartingTrip,n.props.participant.id)})),g(h(n),"dropMoveHandler",(function(e,t){var a=document.elementsFromPoint(e,t).filter((function(e){return e.classList.contains("dropTarget")}));0==a.length?n.props.dropHandlers.dragSet(null):1==a.length&&n.props.dropHandlers.dragSet(a[0].dataset)})),g(h(n),"dropEndHandler",(function(){n.props.dropHandlers.endDrag()})),g(h(n),"clickListener",(function(){n.props.showPopup({view:I,newMode:!1,id:n.props.participant.id})})),g(h(n),"dropHandler",(function(){})),g(h(n),"showDropOutline",(function(){0==n.state.dragpos.x&&0==n.state.dragpos.y||n.props.showDropOutline()})),n.state={dragpos:{x:0,y:0}},n.startDragPos={},n.div=React.createRef(),n.holdStart=0,n}return p(a,[{key:"removeMouseListeners",value:function(){window.removeEventListener("mouseup",this.mouseUpListener),window.removeEventListener("mousemove",this.mouseMoveListener)}},{key:"addMouseListeners",value:function(){window.addEventListener("mouseup",this.mouseUpListener),window.addEventListener("mousemove",this.mouseMoveListener)}},{key:"removeTouchListeners",value:function(){window.removeEventListener("touchend",this.touchEndListener),window.removeEventListener("touchmove",this.touchMoveListener)}},{key:"addTouchListeners",value:function(){window.addEventListener("touchend",this.touchEndListener,{passive:!0}),window.addEventListener("touchmove",this.touchMoveListener,{passive:!0})}},{key:"componentDidMount",value:function(){this.div.current.addEventListener("touchstart",this.touchStartListener,{passive:!1}),this.showDropOutline()}},{key:"componentDidUpdate",value:function(){this.showDropOutline()}},{key:"componentWillUnmount",value:function(){this.div.current.removeEventListener("touchstart",this.touchStartListener)}},{key:"render",value:function(){return React.createElement("div",{ref:this.div,className:"carpoolParticipant draggable"+(this.props.isDriver?" driver":"")+(0==this.state.dragpos.x&&0==this.state.dragpos.y?"":" dragging"),onMouseDown:this.mouseDownListener,style:{top:"".concat(this.state.dragpos.y,"px"),left:"".concat(this.state.dragpos.x,"px")}},this.props.participant.personalInformation.name)}}]),a}(),T=function(e){c(a,React.Component);var t=u(a);function a(e){var n;return s(this,a),g(h(n=t.call(this,e)),"eventPressed",(function(){n.props.showPopup({view:j,newMode:!1,id:n.props.eventId})})),n.state={},n}return p(a,[{key:"render",value:function(){var e=this;return console.log(Object.values(this.props.participants).map((function(e){console.log(e.carpool.departing)}))),React.createElement(React.Fragment,null,React.createElement("div",{className:"subtitle"},React.createElement("button",{className:"backbutton",onClick:this.props.goToEvents},"←")," Participant View for ",React.createElement("span",{className:"imbeddedEvent",onClick:this.eventPressed},this.props.events[this.props.eventId].title)),"Click to inspect.",React.createElement("br",null),React.createElement("br",null),React.createElement("div",{className:"participantViewGrid"},React.createElement("div",{className:"key"},"Participant"),React.createElement("div",{className:"key"},"Departing Carpool"),React.createElement("div",{className:"key"},"Returning Carpool"),Object.values(this.props.participants).map((function(t){return React.createElement(S,o({},t,{showPopup:e.props.showPopup,carpools:e.props.carpools,key:t.id}))}))))}}]),a}(),S=function(e){c(a,React.Component);var t=u(a);function a(e){var n;return s(this,a),g(h(n=t.call(this,e)),"participantPressed",(function(){n.props.showPopup({view:I,id:n.props.id})})),g(h(n),"departingCarpoolPressed",(function(){3==n.props.carpool.departing.type&&n.props.showPopup({view:M,id:n.props.carpool.departing.carpoolId})})),g(h(n),"returningCarpoolPressed",(function(){3==n.props.carpool.returning.type&&n.props.showPopup({view:M,id:n.props.carpool.returning.carpoolId})})),g(h(n),"nameOfCarpool",(function(e){var t=e.type,a=e.carpoolId;switch(t){case 0:return"Waitlist";case 1:return"Parent";case 2:return"New Carpool";default:var r=Object.values(n.props.carpools).find((function(e){return e.id==a}));return r?r.name:"<Invalid carpool>"}})),n.state={},n}return p(a,[{key:"render",value:function(){return React.createElement(React.Fragment,{key:this.props.id},React.createElement("div",{onClick:this.participantPressed},this.props.personalInformation.name),React.createElement("div",{onClick:this.departingCarpoolPressed},this.nameOfCarpool(this.props.carpool.departing)),React.createElement("div",{onClick:this.returningCarpoolPressed},this.nameOfCarpool(this.props.carpool.returning)))}}]),a}();function D(e){return e.ctrlKey||e.shiftKey||e.metaKey||e.button&&1==e.button}function N(e){var t={};return Object.keys(e).forEach((function(a,n){var r=a.split("_"),o=t;for(n=0;n<r.length-1;n++)r[n]in o||(o[r[n]]={}),o=o[r[n]];o[r[r.length-1]]=e[a]})),t}function O(e){var t={};return Object.keys(e).forEach((function(a,n){if("object"==r(e[a])){var o=O(e[a]);Object.keys(o).forEach((function(e,n){t[a+"_"+e]=o[e]}))}else t[a]=e[a]})),t}var I=function(e){c(a,React.Component);var t=u(a);function a(e){var r;return s(this,a),g(h(r=t.call(this,e)),"handleCarpoolsChange",(function(e,t){r.setState({modified:n(n({},r.state.modified),{},{carpool:n(n({},r.state.modified.carpool),{},g({},e?"departing":"returning",t))})})})),g(h(r),"handlePersonalInformationChange",(function(e){var t=e.target;r.setState({modified:n(n({},r.state.modified),{},{personalInformation:n(n({},r.state.modified.personalInformation),{},g({},t.name,t.value))})}),console.log(r.state)})),g(h(r),"handleHide",(function(e){e.currentTarget===e.target&&r.cancelClicked()})),g(h(r),"cancelClicked",(function(){r.props.hidePopup()})),g(h(r),"saveClicked",(function(){var e=O(n({id:r.props.id},r.state.modified));console.log(e),fetch("api/edit-participant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.cancelClicked()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage)})),g(h(r),"deleteClicked",(function(){var e=O({id:r.props.id});fetch("api/delete-participant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.cancelClicked()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage)})),console.log(e.participants,e.id),r.state={modified:f(e.participants[e.id])},console.log(r.state),r}return p(a,[{key:"render",value:function(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"popup-wrapper",onClick:this.handleHide},React.createElement("div",{className:"popup"},React.createElement("div",{className:"infoGrid"},React.createElement("label",null,React.createElement("span",null,"Name: "),React.createElement("input",{name:"name",value:this.state.modified.personalInformation.name,onChange:this.handlePersonalInformationChange})),React.createElement("label",null,React.createElement("span",null,"Email: "),React.createElement("input",{name:"email",value:this.state.modified.personalInformation.email,onChange:this.handlePersonalInformationChange})),React.createElement("label",null,React.createElement("span",null,"Number: "),React.createElement("input",{name:"number",value:this.state.modified.personalInformation.number,onChange:this.handlePersonalInformationChange})),React.createElement("label",null,React.createElement("span",null,"Note: "),React.createElement("br",null),React.createElement("textarea",{name:"note",value:this.state.modified.personalInformation.note,onChange:this.handlePersonalInformationChange}))),React.createElement("div",{style:{marginBottom:".5em"}},"Departing Trip: ",React.createElement(y,{includeNewCarpool:!1,participants:this.props.participants,isDepartingTrip:!0,availableCarpools:this.props.availableCarpools,selectedCarpools:this.state.modified.carpool,selectedCarpoolsChangeHandler:this.handleCarpoolsChange}),"  Returning Trip: ",React.createElement(y,{includeNewCarpool:!1,participants:this.props.participants,isDepartingTrip:!1,availableCarpools:this.props.availableCarpools,selectedCarpools:this.state.modified.carpool,selectedCarpoolsChangeHandler:this.handleCarpoolsChange})),React.createElement("button",{type:"button",name:"button",onClick:this.saveClicked},"Save")," ",React.createElement("button",{type:"button",name:"button",onClick:this.cancelClicked},"Cancel")," ",React.createElement("button",{type:"button",name:"button",onClick:this.deleteClicked},"Delete"))))}}]),a}(),M=function(e){c(a,React.Component);var t=u(a);function a(e){var r;return s(this,a),g(h(r=t.call(this,e)),"handleCarpoolChange",(function(e){var t=e.target;if("seats"==t.name){var a=parseInt(t.value);if(""==t.value&&(a=0),isNaN(a))return;return a<1&&(a=1),a>200&&(a=200),void r.setState({modified:n(n({},r.state.modified),{},{seats:a})})}r.setState({modified:n(n({},r.state.modified),{},g({},t.name,t.value))})})),g(h(r),"handleHide",(function(e){e.currentTarget===e.target&&r.cancelClicked()})),g(h(r),"cancelClicked",(function(){r.props.hidePopup()})),g(h(r),"saveClicked",(function(){var e=O(n({id:r.props.id},r.state.modified));console.log(e),fetch("api/edit-carpool",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.cancelClicked()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage)})),g(h(r),"deleteClicked",(function(){var e=O({id:r.props.id});fetch("api/delete-carpool",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.cancelClicked()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage)})),console.log(e.participants,e.id),r.state={modified:f(e.carpools[e.id])},console.log(r.state),r}return p(a,[{key:"render",value:function(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"popup-wrapper",onClick:this.handleHide},React.createElement("div",{className:"popup"},React.createElement("div",{className:"infoGrid"},React.createElement("label",null,React.createElement("span",null,"Name: "),React.createElement("input",{name:"name",value:this.state.modified.name,onChange:this.handleCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Origin: "),React.createElement("input",{name:"origin",value:this.state.modified.origin,onChange:this.handleCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Departing Time: "),React.createElement("input",{name:"departingTime",value:this.state.modified.departingTime,onChange:this.handleCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Return Time: "),React.createElement("input",{name:"returningTime",value:this.state.modified.returningTime,onChange:this.handleCarpoolChange})),React.createElement("label",null,React.createElement("span",null,"Seats: "),React.createElement("input",{type:"number",name:"seats",value:this.state.modified.seats,onChange:this.handleCarpoolChange}),"  (Include Driver)"),React.createElement("label",null,React.createElement("span",null,"Note: "),React.createElement("br",null),React.createElement("textarea",{name:"note",value:this.state.modified.note,onChange:this.handleCarpoolChange}))),React.createElement("button",{type:"button",name:"button",onClick:this.saveClicked},"Save")," ",React.createElement("button",{type:"button",name:"button",onClick:this.cancelClicked},"Cancel")," ",React.createElement("button",{type:"button",name:"button",onClick:this.deleteClicked},"Delete"))))}}]),a}(),j=function(e){c(a,React.Component);var t=u(a);function a(e){var r;return s(this,a),g(h(r=t.call(this,e)),"handleChange",(function(e){var t=e.target;r.setState({modified:n(n({},r.state.modified),{},g({},t.name,t.value))}),console.log(r.state)})),g(h(r),"handleHide",(function(e){e.currentTarget===e.target&&r.cancelClicked()})),g(h(r),"cancelClicked",(function(){r.props.hidePopup()})),g(h(r),"saveClicked",(function(){var e=O(n({id:r.props.id},r.state.modified));console.log(e),fetch("api/edit-event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.cancelClicked()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage)})),g(h(r),"addClicked",(function(){var e=O(n({},r.state.modified));console.log(e),fetch("api/add-event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.cancelClicked()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage),r.cancelClicked()})),g(h(r),"deleteClicked",(function(){var e=O({id:r.props.id});fetch("api/delete-event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(v).then((function(e){r.props.popupMessageFunctions.generateServerResponsePopupMessage(e),r.cancelClicked()})).catch(r.props.popupMessageFunctions.generateServerErrorPopupMessage),r.cancelClicked()})),e.newMode?r.state={modified:{title:"New Event",note:"",defaultDepartingTime:"",defaultReturningTime:"",date:""}}:r.state={modified:f(e.events[e.id])},console.log(r.state),r}return p(a,[{key:"render",value:function(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"popup-wrapper",onClick:this.handleHide},React.createElement("div",{className:"popup"},React.createElement("div",{className:"infoGrid"},React.createElement("input",{name:"title",value:this.state.modified.title,className:"title",onChange:this.handleChange}),React.createElement("label",null,React.createElement("span",null,"Default Departing Time")," ",React.createElement("input",{name:"defaultDepartingTime",value:this.state.modified.defaultDepartingTime,onChange:this.handleChange})),React.createElement("label",null,React.createElement("span",null,"Default Returning Time")," ",React.createElement("input",{name:"defaultReturningTime",value:this.state.modified.defaultReturningTime,onChange:this.handleChange})),React.createElement("label",null,React.createElement("span",null,"Date")," ",React.createElement("input",{name:"date",value:this.state.modified.date,onChange:this.handleChange})),React.createElement("textarea",{className:"note",name:"note",value:this.state.modified.note,onChange:this.handleChange})),this.props.newMode?React.createElement("button",{type:"button",name:"button",onClick:this.addClicked},"Add"):React.createElement("button",{type:"button",name:"button",onClick:this.saveClicked},"Save")," ",React.createElement("button",{type:"button",name:"button",onClick:this.cancelClicked},"Cancel")," ",this.props.newMode?null:React.createElement("button",{type:"button",name:"button",onClick:this.deleteClicked},"Delete"))))}}]),a}(),L=function(e){c(a,React.Component);var t=u(a);function a(e){var r;if(s(this,a),g(h(r=t.call(this,e)),"popStateListener",(function(e){null==e.state?r.setState({view:"event-list"}):r.setState({view:e.state.view,eventId:e.state.eventId})})),g(h(r),"changeView",(function(e,t,a){if(a)r.searchParams.set("view",e),r.searchParams.set("eventId",t),window.open("?"+r.searchParams.toString());else{r.setState({view:e,eventId:t}),r.searchParams.set("view",e),r.searchParams.set("eventId",t);var n={view:e,eventId:t};history.pushState(n,"","?"+r.searchParams.toString())}})),g(h(r),"goToEvents",(function(e){r.changeView("event-list",-1,!!e&&D(e))})),g(h(r),"showPopup",(function(e){r.setState({shownPopup:e})})),g(h(r),"hidePopup",(function(e){r.setState({shownPopup:{view:null,id:-1,newMode:!1}})})),g(h(r),"showPopupMessage",(function(e){r.setState({shownPopupMessage:e})})),g(h(r),"hidePopupMessage",(function(){r.setState({shownPopupMessage:null})})),g(h(r),"generateServerResponsePopupMessage",(function(e){try{var t=JSON.parse(e);"failure"==t.result?r.showPopupMessage({message:t.error,type:H.error}):"success"==t.result||r.showPopupMessage({message:"Invalid server response",type:H.error})}catch(e){r.showPopupMessage({message:"Invalid server response",type:H.error})}})),g(h(r),"generateServerErrorPopupMessage",(function(e){r.showPopupMessage({message:""+e,type:H.error})})),r.state={shownPopup:{view:null,id:-1},receivedResponse:!1,participants:{},carpools:{},events:{},shownPopupMessage:null},r.searchParams=new URLSearchParams(window.location.search),["add-form","driver-view","participant-view"].includes(r.searchParams.get("view"))){var o=parseInt(r.searchParams.get("eventId"));isNaN(o)?r.state.view="event-list":(r.state.view=r.searchParams.get("view"),r.state.eventId=o)}else r.state.view="event-list";Promise.all([fetch("api/events",{method:"GET"}),fetch("api/carpools",{method:"GET"}),fetch("api/participants",{method:"GET"})]).then((function(e){return Promise.all(e.map((function(e){return e.json()})))})).then((function(e){r.setState((function(t){return n(n({},t),{},{receivedResponse:!0,events:n(n({},t.events),e[0].events.reduce((function(e,t){return n(n({},e),{},g({},t.id,N(t)))}),{})),carpools:n(n({},t.carpools),e[1].carpools.reduce((function(e,t){return n(n({},e),{},g({},t.id,N(t)))}),{})),participants:n(n({},t.participants),e[2].participants.reduce((function(e,t){return n(n({},e),{},g({},t.id,N(t)))}),{}))})}))}));var i=new EventSource("api/update-stream");return i.addEventListener("put-event",(function(e){var t=N(JSON.parse(e.data));r.setState((function(e){return n(n({},e),{},{events:n(n({},e.events),{},g({},t.id,t))})}))})),i.addEventListener("delete-event",(function(e){var t=N(JSON.parse(e.data));r.setState((function(e){var a=Object.assign({},e.events);return delete a[t.id],n(n({},e),{},{participants:R(e.participants,(function(e,a){return a.eventId!=t.id})),carpools:R(e.carpools,(function(e,a){return a.eventId!=t.id})),events:a})}))})),i.addEventListener("put-participant",(function(e){var t=N(JSON.parse(e.data));console.log("parsed",t),r.setState((function(e){return n(n({},e),{},{participants:n(n({},e.participants),{},g({},t.id,t))})}))})),i.addEventListener("delete-participant",(function(e){var t=N(JSON.parse(e.data));console.log("parsed",t),r.setState((function(e){var a=Object.assign({},e.participants);return delete a[t.id],n(n({},e),{},{participants:a})}))})),i.addEventListener("put-carpool",(function(e){var t=N(JSON.parse(e.data));console.log("parsed",t),r.setState((function(e){return n(n({},e),{},{carpools:n(n({},e.carpools),{},g({},t.id,t))})}))})),i.addEventListener("delete-carpool",(function(e){var t=N(JSON.parse(e.data));console.log("parsed",t),r.setState((function(e){var a=Object.assign({},e.carpools);return delete a[t.id],n(n({},e),{},{carpools:a})}))})),i.addEventListener("refresh-participants",(function(e){fetch("api/participants",{method:"GET"}).then((function(e){return e.json()})).then((function(e){r.setState((function(t){return n(n({},t),{},{receivedResponse:!0,participants:n({},e.participants.reduce((function(e,t){return n(n({},e),{},g({},t.id,N(t)))}),{}))})}))}))})),r.popupMessageFunctions={showPopupMessage:r.showPopupMessage,generateServerResponsePopupMessage:r.generateServerResponsePopupMessage,generateServerErrorPopupMessage:r.generateServerErrorPopupMessage},r}return p(a,[{key:"componentDidMount",value:function(){window.addEventListener("popstate",this.popStateListener)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.popStateListener)}},{key:"render",value:function(){for(var e={},t={},a=0,n=Object.keys(this.state.events);a<n.length;a++){var r=n[a];e[r]={},t[r]={}}for(var s=0,i=Object.keys(this.state.carpools);s<i.length;s++){var p=i[s],c=this.state.carpools[p];e[c.eventId][p]=Object.assign({takenDeparting:0,takenReturning:0},c)}for(var l=0,u=Object.keys(this.state.participants);l<u.length;l++){var d=u[l],h=this.state.participants[d];if(t[h.eventId][d]=h,3==h.carpool.departing.type){var m=h.carpool.departing.carpoolId;m in e[h.eventId]?e[h.eventId][m].takenDeparting++:console.log("warning: participant in invalid carpool",h)}if(3==h.carpool.returning.type){var g=h.carpool.returning.carpoolId;g in e[h.eventId]?e[h.eventId][g].takenReturning++:console.log("warning: participant in invalid carpool",h)}}for(var v=Object.assign({},this.state.events),f=0,R=Object.keys(this.state.events);f<R.length;f++){for(var w=R[f],y={amountCarpools:0,totalCapacity:0,takenDeparting:0,takenReturning:0,departingWaitlist:0,returningWaitlist:0},P=0,k=Object.keys(e[w]);P<k.length;P++){var S=k[P],D=e[w][S];y.amountCarpools++,y.totalCapacity+=parseInt(D.seats)}for(var N=0,O=Object.keys(t[w]);N<O.length;N++){var L=O[N],F=t[w][L];switch(F.carpool.departing.type){case 0:y.departingWaitlist++;break;case 1:break;default:y.takenDeparting++}switch(F.carpool.returning.type){case 0:y.returningWaitlist++;break;case 1:break;default:y.takenReturning++}}v[w]=Object.assign({stats:y},v[w])}var x=null,V=null,_=React.createElement(React.Fragment,null,React.createElement("div",null,"Invalid Event"),React.createElement("button",{type:"button",name:"button",onClick:this.goToEvents},"Go back"));if(this.state.receivedResponse){switch(this.state.view){case"event-list":x=React.createElement(E,{popupMessageFunctions:this.popupMessageFunctions,goToEvents:this.goToEvents,showPopup:this.showPopup,changeView:this.changeView,events:v});break;case"add-form":var J=this.state.eventId;x=J in this.state.events?React.createElement(C,{popupMessageFunctions:this.popupMessageFunctions,goToEvents:this.goToEvents,showPopup:this.showPopup,changeView:this.changeView,events:this.state.events,eventId:J,participants:t[J],availableCarpools:e[J]}):_;break;case"driver-view":var W=this.state.eventId;x=W in this.state.events?React.createElement(b,{popupMessageFunctions:this.popupMessageFunctions,goToEvents:this.goToEvents,showPopup:this.showPopup,changeView:this.changeView,events:this.state.events,eventId:W,carpools:e[W],participants:t[W]}):_;break;case"participant-view":var G=this.state.eventId;x=G in this.state.events?React.createElement(T,{popupMessageFunctions:this.popupMessageFunctions,goToEvents:this.goToEvents,showPopup:this.showPopup,changeView:this.changeView,events:this.state.events,eventId:G,carpools:e[G],participants:t[G]}):_}switch(this.state.shownPopup.view){case I:if(!(this.state.shownPopup.id in this.state.participants))break;var Y=this.state.participants[this.state.shownPopup.id].eventId;V=React.createElement(I,{popupMessageFunctions:this.popupMessageFunctions,hidePopup:this.hidePopup,availableCarpools:e[Y],participants:this.state.participants,id:this.state.shownPopup.id});break;case M:if(!(this.state.shownPopup.id in this.state.carpools))break;this.state.carpools[this.state.shownPopup.id].eventId;V=React.createElement(M,{popupMessageFunctions:this.popupMessageFunctions,hidePopup:this.hidePopup,carpools:this.state.carpools,id:this.state.shownPopup.id});break;case j:if(!this.state.shownPopup.newMode&&!(this.state.shownPopup.id in this.state.events))break;V=React.createElement(j,{popupMessageFunctions:this.popupMessageFunctions,hidePopup:this.hidePopup,newMode:this.state.shownPopup.newMode,events:this.state.events,id:this.state.shownPopup.id})}}else x=React.createElement("div",null,"Loading...");return React.createElement(React.Fragment,null,V,x,this.state.shownPopupMessage?React.createElement(H,o({hidePopupMessage:this.hidePopupMessage},this.state.shownPopupMessage)):null)}}]),a}(),H=function(e){c(a,React.Component);var t=u(a);function a(e){return s(this,a),t.call(this,e)}return p(a,[{key:"render",value:function(){return React.createElement("div",{className:"overlayMessage"+(this.props.type==a.error?" error":" message")},React.createElement("div",null,this.props.message),React.createElement("button",{className:"closeButton",onClick:this.props.hidePopupMessage},"X"))}}]),a}();g(H,"error",0),g(H,"message",1),g(H,"warning",2),ReactDOM.render(React.createElement(L,{view:""}),document.getElementById("root"))}]);